---
phase: 01-infoplist-uti-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [QuickLookPreview/Info.plist, dotViewer/Info.plist]
autonomous: true
---

<objective>
Fix custom file type activation by adding common dotfile UTI declarations and JavaScript module extensions (.mjs, .cjs) to Info.plist files.

Purpose: Enable QuickLook preview for common dotfiles (.bashrc, .zshrc, .gitconfig, etc.) and JavaScript ES modules without requiring user to add custom extensions.
Output: Updated Info.plist files with proper UTI registrations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@QuickLookPreview/Info.plist
@dotViewer/Info.plist
@Shared/LanguageDetector.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dotfile UTI declarations to main app Info.plist</name>
  <files>dotViewer/Info.plist</files>
  <action>
Add new UTExportedTypeDeclarations for common dotfiles that aren't covered by existing UTIs. Create two new custom UTI types:

1. **Shell dotfiles** (`com.stianlars1.dotviewer.shell-dotfile`):
   - Description: "Shell Configuration"
   - Conforms to: public.shell-script, public.plain-text
   - Extensions: bashrc, bash_profile, bash_aliases, bash_logout, zshrc, zshenv, zprofile, zlogin, zlogout, profile

2. **Git dotfiles** (`com.stianlars1.dotviewer.git-dotfile`):
   - Description: "Git Configuration"
   - Conforms to: public.plain-text
   - Extensions: gitconfig, gitignore, gitattributes, gitmodules

3. **JavaScript modules** (`com.stianlars1.dotviewer.javascript-module`):
   - Description: "JavaScript Module"
   - Conforms to: public.source-code, public.plain-text
   - Extensions: mjs, cjs

Add these after the existing UTExportedTypeDeclarations array entries, before the closing </array> tag.

Note: Extensions are specified WITHOUT the leading dot (e.g., "bashrc" not ".bashrc") - macOS handles the dot prefix automatically for dotfiles.
  </action>
  <verify>Open dotViewer/Info.plist and verify the three new UTI declarations exist with correct structure</verify>
  <done>dotViewer/Info.plist contains UTExportedTypeDeclarations for shell-dotfile, git-dotfile, and javascript-module UTIs</done>
</task>

<task type="auto">
  <name>Task 2: Add UTI references to QuickLook extension Info.plist</name>
  <files>QuickLookPreview/Info.plist</files>
  <action>
Add the new custom UTI identifiers to the QLSupportedContentTypes array:

1. Add `com.stianlars1.dotviewer.shell-dotfile`
2. Add `com.stianlars1.dotviewer.git-dotfile`
3. Add `com.stianlars1.dotviewer.javascript-module`

Insert these after the existing custom UTI entries (after `com.stianlars1.dotviewer.zsh-theme`) and before the generic types (before `public.plain-text`).

This tells macOS to route files matching these UTIs to the QuickLook extension.
  </action>
  <verify>Open QuickLookPreview/Info.plist and verify the three new UTI identifiers are in QLSupportedContentTypes</verify>
  <done>QuickLookPreview/Info.plist QLSupportedContentTypes includes shell-dotfile, git-dotfile, and javascript-module UTIs</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] dotViewer/Info.plist has 3 new UTExportedTypeDeclarations entries
- [ ] QuickLookPreview/Info.plist has 3 new QLSupportedContentTypes entries
- [ ] Both Info.plist files are valid XML (no syntax errors)
- [ ] Build succeeds: `xcodebuild -project dotViewer.xcodeproj -scheme dotViewer -configuration Debug build 2>&1 | tail -5`
</verification>

<success_criteria>
- All tasks completed
- Both Info.plist files properly configured
- Project builds without errors
- UTI declarations use correct format and identifiers
</success_criteria>

<output>
After completion, create `.planning/phases/01-infoplist-uti-fixes/01-01-SUMMARY.md`
</output>
